FROM library/php:7.4
LABEL maintainer="Bobby Hines <bobbyahines@gmail.com>"
LABEL image="bobbyahines/php:7.4"

# Export terminal processes for use of editors in container
ENV TERM xterm

# Update repos and install system/security updates
RUN apt-get update && apt-get dist-upgrade -y

# Install required utility programs
RUN apt-get install -y curl libfontconfig1 libxrender1 nano wget

#Install/Enable gd library
RUN apt-get install -y libfreetype6-dev libjpeg62-turbo-dev libpng-dev \
    && docker-php-ext-configure gd \
    && docker-php-ext-install -j$(nproc) gd

#Install Mysqli Library
RUN docker-php-ext-install -j$(nproc) mysqli

# Install/Enable PDO mysql driver
RUN docker-php-ext-install -j$(nproc) pdo_mysql \
    && docker-php-ext-configure pdo_mysql

# Install/Enable API and PDO postgres drivers
#RUN apt-get update && apt-get install -y php7.4-pgsql
RUN apt-get update && apt-get install -y libpq-dev
RUN docker-php-ext-configure pgsql -with-pgsql=/usr/local/pgsql
RUN docker-php-ext-install pdo_pgsql pgsql

# Install/Enable PHP Zip extension
RUN apt-get install -y libzip-dev zlib1g-dev zip \
    && docker-php-ext-install zip

# Establish working directory
WORKDIR /srv

# Establish volume directory
VOLUME /srv
